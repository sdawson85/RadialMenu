<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:Controls="clr-namespace:RadialMenu.Controls"
    xmlns:Converters="clr-namespace:RadialMenu.Converters">

    <Converters:ChildToIndex x:Key="ChildToIndex"/>

    <Style x:Key="CentralMenuItem" TargetType="{x:Type Button}">
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="IsEnabled" Value="True" />
        <Setter Property="BorderBrush" Value="#CCCCCC" />
        <Setter Property="Panel.ZIndex" Value="0" />
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="BorderBrush" Value="#999999"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#666666"/>
                <Setter Property="BorderBrush" Value="#666666"/>
                <Setter Property="Panel.ZIndex" Value="10" />
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="BorderBrush" Value="#E3E3E3"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="{x:Type Controls:RadialMenu}">

        <Style.Triggers>
            <Trigger Property="IsOpen" Value="True">
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.4"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[0].ScaleX" From="0.5" To="1" Duration="0:0:0.4"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[0].ScaleY" From="0.5" To="1" Duration="0:0:0.4"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[1].Angle" From="-50" To="0" Duration="0:0:0.4"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
                
                <Trigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.4"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[0].ScaleX" From="1" To="0.5" Duration="0:0:0.4"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[0].ScaleY" From="1" To="0.5" Duration="0:0:0.4"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[1].Angle" From="0" To="-50" Duration="0:0:0.4"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.ExitActions>
            </Trigger>
            
            <!--<Trigger Property="IsOpen" Value="False">
                <Trigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.6"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[0].ScaleX" From="1" To="0.5" Duration="0:0:0.6"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[0].ScaleY" From="1" To="0.5" Duration="0:0:0.6"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Children[1].Angle" From="0" To="-60" Duration="0:0:0.6"/>
                        </Storyboard>
                    </BeginStoryboard>
                </Trigger.EnterActions>
            </Trigger>-->
        </Style.Triggers>
        
        <Setter Property="Opacity" Value="0"/>
        
        <Setter Property="RenderTransform">
            <Setter.Value>
                <TransformGroup>
                    <ScaleTransform CenterX="155" CenterY="155" ScaleX="0.5" ScaleY="0.5"/>
                    <RotateTransform CenterX="155" CenterY="155" Angle="45"/>
                </TransformGroup>
            </Setter.Value>
        </Setter>

        <Setter Property="Height" Value="310"/>

        <Setter Property="Width" Value="310"/>

        <Setter Property="Background" Value="Red"/>

        <Setter Property="Template">
            <Setter.Value>

                <ControlTemplate TargetType="{x:Type Controls:RadialMenu}">
                    <Controls:RadialMenuItemsControl ItemsSource="{TemplateBinding Content}">

                        <ItemsControl.Template>
                            <ControlTemplate>
                                <Grid>
                                    <ItemsPresenter/>
                                    <Button Style="{StaticResource CentralMenuItem}" Command="{Binding CentralMenuCommand, RelativeSource={RelativeSource AncestorType=Controls:RadialMenu}}" Width="60" Height="60">
                                        <Button.Template>
                                            <ControlTemplate>
                                                <Grid>
                                                    <Ellipse Stroke="{TemplateBinding BorderBrush}" StrokeThickness="2" Fill="Transparent"></Ellipse>
                                                    <ContentControl VerticalAlignment="Center" HorizontalAlignment="Center" Content="{Binding CentralMenuItem, RelativeSource={RelativeSource AncestorType=Controls:RadialMenu}}"/>
                                                </Grid>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </Grid>
                            </ControlTemplate>
                        </ItemsControl.Template>

                        <!--<ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <Grid Width="310" Height="310"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>-->

                        <!--<ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Controls:RadialMenuItem Command="{Binding Command}" Content="{Binding Content}">

                                    <Controls:RadialMenuItem.Index>
                                        <MultiBinding Converter="{StaticResource ChildToIndex}">
                                            <Binding Path="."/>
                                            <Binding Path="Content" RelativeSource="{RelativeSource AncestorType=Controls:RadialMenu}"/>
                                        </MultiBinding>
                                    </Controls:RadialMenuItem.Index>

                                    <Controls:RadialMenuItem.Count>
                                        <Binding Path="Content.Count" RelativeSource="{RelativeSource AncestorType=Controls:RadialMenu}"/>
                                    </Controls:RadialMenuItem.Count>

                                </Controls:RadialMenuItem>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>-->
                                
                    </Controls:RadialMenuItemsControl>
                </ControlTemplate>
                
            </Setter.Value>
        </Setter>
    </Style>
    
</ResourceDictionary>
